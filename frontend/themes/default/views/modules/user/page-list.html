<breadcrumbs>
    <crumb href="'/'" title="'Мой кабинет'|translate" />
    <crumb href="'/administration'" title="'Администрирование'|translate" />
    <crumb title="'Пользователи'|translate" />
</breadcrumbs>

<div class="padded">

    <div class="page-header">
        <div class="table-actions">

            <a href="/users/create" class="btn btn-success btn-sm">
                <i class="fa fa-plus"></i> {{'Добавить пользователя'|translate}}
            </a>

            <div class="btn-group" ng-show="checkboxes.checkedAny">
                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                    {{'Действия'|translate}} <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="" data-ng-click="disableChecked(checkboxes.items)">{{'Заблокировать'|translate}}</a></li>
                    <li><a href="" data-ng-click="enableChecked(checkboxes.items)">{{'Активировать'|translate}}</a></li>

                </ul>
            </div>
            <a ng-show="checkboxes.checkedAny"  bz-confirm="deleteChecked(checkboxes.items)" message="'Удалить?'" title="{{'Удалить'|translate}}" class="btn btn-danger btn-sm">
                <span class="fa fa-fa-times"></span> {{'Удалить'|translate}}
            </a>
        </div>

        <h1>{{'Пользователи'|translate}}</h1>
    </div>

    <div class="main-content" bz-loading-container="loading">
        <table ng-table="tableParams" class="table ng-table-responsive table-striped table-condensed table-hover table-users"
               show-filter="true">
            <tr ng-repeat="user in users">

                <td width="20" style="text-align: left;" header="'/themes/default/views/block/ng-table/headers/checkbox.html'">
                    <input type="checkbox" ng-model="checkboxes.items[user.id]"/>
                </td>

                <td class="table-preview" data-title="'ФИО'" filter="{ 'fullname': 'text' }" sortable="'fullname'">
                    <a class="name" href="/users/view/{{user.id}}" title="{{'Редактировать'|translate}}">
                        <img alt="" ng-src="{{(user.photo_thumb ? user.photo_thumb : '/themes/default/assets/img/defaultuser.jpg')}}"
                             src="/themes/default/assets/img/defaultuser.jpg"
                             class="img-circle avatar">
                        {{user.fullname}}
                    </a>
                    <span class="subtext label label-default" ng-if="user.is_active && user.need_edit">{{'Не заполнен'|translate}}</span>
                    <span class="subtext label label-danger" ng-if="!user.is_active">{{'Заблокирован'|translate}}</span>
                </td>
                <td data-title="'Email'" filter="{ 'email': 'text' }" sortable="'email'">
                    {{user.email}}
                </td>
                <!-- В системі нема логіну, так як в нас швидка реєстрація -->
                <!--td data-title="'Логин'" filter="{ 'login': 'text' }" sortable="login">
                    {{user.login}}
                </td-->
                <td data-title="'Роли'" filter="{ 'roles': 'select' }" filter-data="filterRoles($column)"
                    sortable="'roles'">
                    {{user.roles}}
                </td>
                <td width="150" data-title="'Дата регистрации'" filter="{ 'created_at': 'date', 'templateURL': '/themes/default/views/block/ng-table/filters/date.html' }" sortable="'created_at'">
                    {{user.created_at|date:'yyyy-MM-dd'}}<br/>
                    {{user.created_at|date:'HH:mm:ss'}}
                </td>
                <td width="150" data-title="'Дата последней активности'" filter="{ 'last_activity': 'date', 'templateURL': '/themes/default/views/block/ng-table/filters/date.html' }"
                    sortable="'last_activity'">
                    {{user.last_activity|date:'yyyy-MM-dd'}}<br/>
                    {{user.last_activity|date:'HH:mm:ss'}}
                </td>
                <td width="135" data-title="'Действия'" class="actions text-center"  filter="{ 'clear': 'clear', 'templateURL': '/themes/default/views/block/ng-table/filters/clear.html' }">
                    <div class="btn-group">
                        <a class="" ng-click="enable(user)" ng-show="!user.is_active" href=""
                           title="{{'Разблокировать'|translate}}"><span class="fa fa-lock"></span></a>
                        <a class="" ng-click="disable(user)" ng-show="user.is_active" href=""
                           title="{{'Заблокировать'|translate}}"><span class="fa fa-unlock"></span></a>
                        <a class="" href="/users/edit/{{user.id}}"
                           title="{{'Редактировать'|translate}}"><span class="fa fa-pencil"></span></a>
                        <a class="" href="/users/change-roles/{{user.id}}"
                           title="{{'Выбрать роли'|translate}}"><span class="fa fa-cogs"></span></a>
                        <a class="" href="" bz-confirm="remove(user)" message="'Удалить?'"
                           title="{{'Удалить'|translate}}"><span class="fa fa-times text-danger"></span></a>
                    </div>
                </td>
            </tr>
        </table>
        <script type="text/ng-template" id="ng-table/headers/checkbox.html">
            <input type="checkbox" ng-model="checkboxes.checked" id="select_all" name="filter-checkbox" value="" />
        </script>
    </div>
</div>

